<!doctype html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Fluctuation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='stylesheets/fluctuation.css') }}">
</head>
<body>
    <h1>データの変動（Fluctuation）</h1>
    <a href="/">TOPへ</a>

    <canvas id="moodChart"></canvas>
    <canvas id="sleepChart"></canvas>
    <canvas id="trainingChart"></canvas>
    <canvas id="weightChart"></canvas>
    <canvas id="typingSpeedChart"></canvas>
    <canvas id="typingAccuracyChart"></canvas>

    <script>
    const dates = {{ dates|tojson }};
    const mood = {{ mood_list|tojson }};
    const sleep = {{ sleep_time_list|tojson }};
    const training = {{ training_time_list|tojson }};
    const weight = {{ weight_list|tojson }};
    const typing_speed = {{ typing_speed_list|tojson }};
    const typing_accuracy = {{ typing_accuracy_list|tojson }};

    function createChart(ctxId, label, data, color) {
        const min = Math.min(...data.filter(x => x !== null));
        const max = Math.max(...data.filter(x => x !== null));
        new Chart(document.getElementById(ctxId), {
            type: 'line',
            data: { labels: dates, datasets: [{ label: label, data: data, borderColor: color, fill: false }] },
            options: {
                scales: {
                    y: {
                        suggestedMin: min - (max - min) * 0.1, // 少し余白
                        suggestedMax: max + (max - min) * 0.1
                    }
                }
            }
        });
    }

    createChart('moodChart', '気分スコア', mood, 'purple');
    createChart('sleepChart', '睡眠時間(時間)', sleep, 'green');
    createChart('trainingChart', 'トレーニング時間(分)', training, 'red');
    createChart('weightChart', '体重(kg)', weight, 'orange');
    createChart('typingSpeedChart', 'タイピング速度', typing_speed, 'blue');
    createChart('typingAccuracyChart', 'タイピング精度', typing_accuracy, 'cyan');
    </script>
</body>
</html>
