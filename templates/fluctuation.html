<!doctype html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Fluctuation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='stylesheets/fluctuation.css') }}">
</head>
<body>
    <h1>データの変動（Fluctuation）</h1>
    <a href="/">TOPへ</a>

    <canvas id="moodChart"></canvas>
    <canvas id="sleepChart"></canvas>
    <canvas id="trainingChart"></canvas>
    <canvas id="weightChart"></canvas>
    <canvas id="typingSpeedChart"></canvas>
    <canvas id="typingAccuracyChart"></canvas>

    <script>
    const dates = {{ dates|tojson }};
    const mood = {{ mood_list|tojson }};
    const sleep = {{ sleep_time_list|tojson }};
    const training = {{ training_time_list|tojson }};
    const weight = {{ weight_list|tojson }};
    const typing_speed = {{ typing_speed_list|tojson }};
    const typing_accuracy = {{ typing_accuracy_list|tojson }};

    const dataMap = {
        'moodChart': {label: '気分スコア', data: mood, color: 'purple'},
        'sleepChart': {label: '睡眠時間(時間)', data: sleep, color: 'green'},
        'trainingChart': {label: 'トレーニング時間(分)', data: training, color: 'red'},
        'weightChart': {label: '体重(kg)', data: weight, color: 'orange'},
        'typingSpeedChart': {label: 'タイピング速度', data: typing_speed, color: 'blue'},
        'typingAccuracyChart': {label: 'タイピング精度', data: typing_accuracy, color: 'cyan'}
    };

    for (const [canvasId, info] of Object.entries(dataMap)) {
        new Chart(document.getElementById(canvasId), {
            type: 'line',
            data: {
                labels: dates,
                datasets: [{
                    label: info.label,
                    data: info.data,
                    borderColor: info.color,
                    fill: false,
                    spanGaps: true  // null値はスキップして線を繋ぐ
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: false,
                        ticks: {
                            // 小数点の表示を調整（必要なら）
                            callback: function(value) { return value; }
                        }
                    }
                }
            }
        });
    }
    </script>
</body>
</html>
